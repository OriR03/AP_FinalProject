<!DOCTYPE html>
<html>
<head>
<title>Graph</title>
<style>
    body { font-family: sans-serif; margin: 0; }
    #cy {
        width: 100vw;
        height: 100vh;
        position: absolute;
        top: 0;
        left: 0;
    }
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.23.0/cytoscape.min.js"></script>
</head>
<body>
<div id="cy"></div>
<script>
    /**
     * @param backgroundColor String input ා FFFBBC | FBC | FFBBCC can be used
     * https://www.fatalerrors.org/a/adaptive-text-color-based-on-background-color.html
     */
     function contrastTextColor(backgroundHexColor) {

        let hex = backgroundHexColor

        // If the currently passed in parameter starts with ා, remove the current parameter
        if (hex.startsWith('#')) {
            hex = hex.substring(1);
        }
        // If the current input is a 3-bit decimal value, it is directly converted to 6-bit for processing
        if (hex.length === 3) {
            hex = [hex[0], hex[0], hex[1], hex[1], hex[2], hex[2]].join('')
        }

        if (hex.length !== 6) {
            throw new Error('Invalid background color.' + backgroundHexColor);
        }

        const r = parseInt(hex.slice(0, 2), 16)
        const g = parseInt(hex.slice(2, 4), 16)
        const b = parseInt(hex.slice(4, 6), 16)

        if ([r,g,b].some(x => Number.isNaN(x))) {
            throw new Error('Invalid background color.' + backgroundHexColor);
        }

        const textColor = (r * 0.299 + g * 0.587 + b * 0.114) > 186 ? '#000' : '#FFF'
        return textColor
    }

    const nodes = [
        { data: { id: 'TA', label: 'A', type: 'topic' } },
{ data: { id: 'Aplus_agent1', label: 'plus agent', type: 'agent' } },
{ data: { id: 'Asquare_agent2', label: 'square agent', type: 'agent' } },
{ data: { id: 'Amul_agent1', label: 'mul agent', type: 'agent' } },
{ data: { id: 'TB', label: 'B', type: 'topic' } },
{ data: { id: 'Asquare_agent3', label: 'square agent', type: 'agent' } },
{ data: { id: 'TB2_squared', label: 'B2_squared', type: 'topic' } },
{ data: { id: 'Aplus_agent2', label: 'plus agent', type: 'agent' } },
{ data: { id: 'TD', label: 'D', type: 'topic' } },
{ data: { id: 'Aplus_agent4', label: 'plus agent', type: 'agent' } },
{ data: { id: 'Aplus_agent3', label: 'plus agent', type: 'agent' } },
{ data: { id: 'TResult2', label: 'Result2', type: 'topic' } },
{ data: { id: 'TResult1', label: 'Result1', type: 'topic' } },
{ data: { id: 'Asquare_agent1', label: 'square agent', type: 'agent' } },
{ data: { id: 'TA2_squared', label: 'A2_squared', type: 'topic' } },
{ data: { id: 'TC1', label: 'C1', type: 'topic' } },
{ data: { id: 'TA2_plus_B2_squared', label: 'A2_plus_B2_squared', type: 'topic' } },
{ data: { id: 'TC2', label: 'C2', type: 'topic' } },

    ];
    const edges = [
        { data: { id: 'TA-Aplus_agent1', source: 'TA', target: 'Aplus_agent1' } },
{ data: { id: 'TA-Asquare_agent2', source: 'TA', target: 'Asquare_agent2' } },
{ data: { id: 'TA-Amul_agent1', source: 'TA', target: 'Amul_agent1' } },
{ data: { id: 'Aplus_agent1-TC1', source: 'Aplus_agent1', target: 'TC1' } },
{ data: { id: 'Asquare_agent2-TA2_squared', source: 'Asquare_agent2', target: 'TA2_squared' } },
{ data: { id: 'Amul_agent1-TC2', source: 'Amul_agent1', target: 'TC2' } },
{ data: { id: 'TB-Aplus_agent1', source: 'TB', target: 'Aplus_agent1' } },
{ data: { id: 'TB-Asquare_agent3', source: 'TB', target: 'Asquare_agent3' } },
{ data: { id: 'TB-Amul_agent1', source: 'TB', target: 'Amul_agent1' } },
{ data: { id: 'Asquare_agent3-TB2_squared', source: 'Asquare_agent3', target: 'TB2_squared' } },
{ data: { id: 'TB2_squared-Aplus_agent2', source: 'TB2_squared', target: 'Aplus_agent2' } },
{ data: { id: 'Aplus_agent2-TA2_plus_B2_squared', source: 'Aplus_agent2', target: 'TA2_plus_B2_squared' } },
{ data: { id: 'TD-Aplus_agent4', source: 'TD', target: 'Aplus_agent4' } },
{ data: { id: 'Aplus_agent4-TResult2', source: 'Aplus_agent4', target: 'TResult2' } },
{ data: { id: 'Aplus_agent3-TD', source: 'Aplus_agent3', target: 'TD' } },
{ data: { id: 'Asquare_agent1-TResult1', source: 'Asquare_agent1', target: 'TResult1' } },
{ data: { id: 'TA2_squared-Aplus_agent2', source: 'TA2_squared', target: 'Aplus_agent2' } },
{ data: { id: 'TC1-Asquare_agent1', source: 'TC1', target: 'Asquare_agent1' } },
{ data: { id: 'TA2_plus_B2_squared-Aplus_agent4', source: 'TA2_plus_B2_squared', target: 'Aplus_agent4' } },
{ data: { id: 'TC2-Aplus_agent3', source: 'TC2', target: 'Aplus_agent3' } },
{ data: { id: 'TC2-Aplus_agent3', source: 'TC2', target: 'Aplus_agent3' } },

    ];

    const elements = [...nodes, ...edges];
    const agentColor = '#2596be';
    const topicColor = '#7a81e4';

    function drawGraph() {
        const cy = cytoscape({
            container: document.getElementById('cy'),
            elements: elements,
            style: [ 
                {
                    selector: 'node[type="agent"]',
                    style: {
                        'shape': 'ellipse',
                        'background-color': '#2596be',
                        'label': 'data(label)',
                        'color': contrastTextColor(agentColor),
                        'text-valign': 'center',
                        'text-halign': 'center',
                        'border-width': 2,
                        'border-color': '#999',
                        'width': 'mapData(label.length, 1, 10, 20, 90)', 'height': 'mapData(label.length, 1, 10, 20, 90)'
                    }
                },
                {
                    selector: 'node[type="topic"]',
                    style: {
                        'shape': 'rectangle',
                        'background-color': '#7a81e4',
                        'label': 'data(label)',
                        'color': contrastTextColor(topicColor),
                        'text-valign': 'center',
                        'text-halign': 'center',
                        'border-width': 2,
                        'border-color': '#999',
                        'width': 'mapData(label.length, 1, 10, 20, 90)'
                }
                },
                {
                    selector: 'edge',
                    style: {
                        'width': 2,
                        'line-color': '#ccc',
                        'target-arrow-color': '#ccc',
                        'target-arrow-shape': 'triangle',
                        'curve-style': 'bezier'
                    }
                }
            ],
            layout: {
                name: 'grid',
                grid: false,
                spacingFactor: 1.5
            }
        });
    }

    setTimeout(drawGraph, 0);
</script>
</body>
</html>